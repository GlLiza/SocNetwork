@model network.Views.ViewModels.PageViewModel

@using (Html.BeginForm("Index", "Users"))
{
    <div class="col-lg-6">
    @if (Model.Image!=null)
    {
            <img class="image" src="data:image/png;base64, @Convert.ToBase64String(Model.Image)" />
    }
    else
    {
            <img class="image" style="border:solid;" src="@Url.Content("~/Content/Pictures/no.jpg")" />
    }
        </div>

        <div class="row">
            <div class="page">
                @Html.DisplayFor(model => model.Name)
                @Html.DisplayFor(model => model.Firstname)
                </div>
                <br />
                @Html.DisplayNameFor(model => model.DateOfBirthday)
                @Html.DisplayFor(model => model.DateOfBirthday)
            <br />
                @Html.DisplayNameFor(model => model.CurrentLocation.Country)
                @Html.DisplayFor(model => model.CurrentLocation.Country)

            </div>





            <nav class="navbar navbar-inverse" role="navigation">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-sidebar-navbar-collapse-1">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>


                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="bs-sidebar-navbar-collapse-1">
                        <ul class="nav navbar-nav"></ul>
                    </div>
                </div>
            </nav>

            @*<div>
                        <dd>
                            @if (Model.Image!=null)
                            {
                                <div class="col-md-2">
                                    <div class="row">

                                        <img id="user_img" style="border: solid" src="data:image/png;base64, @Convert.ToBase64String(Model.Image)">
                                    </div>

                                    <input type="button" class="btn-info" id="openModal" value="Change photo" />
                                </div>
                            }

                            else
                            {
                                <div class="col-md-2">
                                    <div class="row">

                                        <img id="user_img" style="border: solid" src="@Url.Content("~/Pictures/no.jpg")">
                                    </div>

                                    <input type="button" class="btn-info" id="openModal" value="Change photo" />
                                </div>
                            }
                        </dd>


                        <dd class="page">
                            @Html.DisplayFor(model => model.Name)
                            @Html.DisplayFor(model => model.Firstname)
                        </dd>



                        <dt>
                                @Html.DisplayNameFor(model => model.DateOfBirthday)
                                @Html.DisplayFor(model => model.DateOfBirthday)
                </dt>

                        <dt>
                            Family status
                            @Html.DisplayFor(model => model.FamStat.Name)
                        </dt>

                        ______________________________________________________

                        <dt>

                            @Html.DisplayNameFor(model => model.CurrentLocation.Country)
                            @Html.DisplayFor(model => model.CurrentLocation.Country)
                        </dt>
                        <hr />

                    </div>*@
            }





            <div id="changeModal" class="modal fade" data-url='@Url.Action("ChangePhoto", "Users",FormMethod.Post)'>
                <div id="changeContainer">
                </div>
            </div>




            @section Scripts{
                <script type="text/javascript">
                    $(function () {
                        $('#openModal').click(function () {
                            var url = $('#changeModal').data('url');

                            $.get(url,
                                function (data) {
                                    $('#changeContainer').html(data);

                                    $('#changeModal').modal('show');
                                });
                        });

                        var bar = $('#Change .progress-bar');
                        var percent = $('#Change .percent');
                        var status = $('#Change #status');

                        $('#Change').ajaxForm({
                            beforeSend: function () {
                                status.empty();
                                var percentVal = '0%';
                                bar.width(percentVal);
                                percent.html(percentVal);
                                alert(percentVal);
                            },
                            uploadProgress: function (event, position, total, percentComplete) {
                                var percentVal = percentComplete + '%';
                                bar.width(percentVal);
                                percent.html(percentVal);
                                alert(percentVal);
                            },
                            complete: function (xhr) {
                                alert("completed");
                                status.html(xhr.responseText);
                            }
                        });
                    });
                </script>
            }
